
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tools for interpolating astrophysical light curves using Gaussian Processes in order to compute frequency-domain and standard time domain data products">
      
      
      
      
        <link rel="prev" href="../gaussian_process/">
      
      
        <link rel="next" href="../lag_frequency_spectrum/">
      
      
      <link rel="icon" href="../../assets/stela_logo_sq.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Lag Energy Spectrum - STELA Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lag_energy_spectrum" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="STELA Toolkit" class="md-header__button md-logo" aria-label="STELA Toolkit" data-md-component="logo">
      
  <img src="../../assets/stela_logo_sq.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            STELA Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lag Energy Spectrum
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="STELA Toolkit" class="md-nav__button md-logo" aria-label="STELA Toolkit" data-md-component="logo">
      
  <img src="../../assets/stela_logo_sq.png" alt="logo">

    </a>
    STELA Toolkit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gaussian_process_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian Processes
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Module Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Module Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coherence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coherence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cross_correlation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cross Correlation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cross_spectrum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cross Spectrum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_simulator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Simulator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frequency_binning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Frequency Binning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gaussian_process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lag Energy Spectrum
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lag Energy Spectrum
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      lag_energy_spectrum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum" class="md-nav__link">
    <span class="md-ellipsis">
      LagEnergySpectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LagEnergySpectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_lag_spectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_lag_spectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.count_frequencies_in_bins" class="md-nav__link">
    <span class="md-ellipsis">
      count_frequencies_in_bins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lag_frequency_spectrum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lag Frequency Spectrum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plotting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../power_spectrum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Power Spectrum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preprocessing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_13" >
        
          
          <label class="md-nav__link" for="__nav_6_13" id="__nav_6_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Internal
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_13">
            <span class="md-nav__icon md-icon"></span>
            Internal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../check_inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    _CheckInputs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clarify_warnings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    _ClearWarnings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      lag_energy_spectrum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum" class="md-nav__link">
    <span class="md-ellipsis">
      LagEnergySpectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LagEnergySpectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_lag_spectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_lag_spectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.count_frequencies_in_bins" class="md-nav__link">
    <span class="md-ellipsis">
      count_frequencies_in_bins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="lag_energy_spectrum">lag_energy_spectrum<a class="headerlink" href="#lag_energy_spectrum" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="stela_toolkit.lag_energy_spectrum"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="stela_toolkit.lag_energy_spectrum.LagEnergySpectrum" class="doc doc-heading">
            <code>LagEnergySpectrum</code>


<a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Compute the time lag as a function of energy between two sets of light curves or GP models.</p>
<p>This class accepts lists of LightCurve objects or trained GaussianProcess models, one per energy bin.
If the inputs are GP models, the most recently generated samples will be used automatically.
If no samples are found, 1000 realizations will be generated on a 1000-point grid.</p>
<p>Each light curve pair (one per energy bin) is used to compute a single lag by integrating the
cross-spectrum over a specified frequency range. This yields one lag per energy bin, forming
the lag-energy spectrum.</p>
<p>A <strong>positive lag</strong> means that the time series in <code>lcs_or_models1</code> is <strong>lagging behind</strong>
the corresponding series in <code>lcs_or_models2</code>.</p>
<p>Coherence values are also computed for each energy bin to assess correlation strength,
and noise bias correction can be applied to the coherence before estimating uncertainties.</p>
<h4 id="stela_toolkit.lag_energy_spectrum.LagEnergySpectrum--parameters">Parameters<a class="headerlink" href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum--parameters" title="Permanent link">&para;</a></h4>
<p>lcs_or_models1 : list of LightCurve or GaussianProcess
    First set of inputs, one per energy bin.
lcs_or_models2 : list of LightCurve or GaussianProcess
    Second set of inputs, matched to <code>lcs_or_models1</code>.
fmin : float
    Minimum frequency to include when integrating.
fmax : float
    Maximum frequency to include when integrating.
bin_edges : array-like
    Edges of the energy bins corresponding to the light curves.
subtract_coh_bias : bool, optional
    Whether to subtract the coherence noise bias before estimating lag uncertainties.</p>
<h4 id="stela_toolkit.lag_energy_spectrum.LagEnergySpectrum--attributes">Attributes<a class="headerlink" href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum--attributes" title="Permanent link">&para;</a></h4>
<p>energies : array-like
    Mean energy of each bin.
energy_widths : array-like
    Half-width of each energy bin.
lags : array-like
    Integrated time lag per energy bin.
lag_errors : array-like
    Uncertainties in each lag value.
cohs : array-like
    Coherence values per energy bin.
coh_errors : array-like
    Uncertainties in the coherence values.</p>







              <details class="quote">
                <summary>Source code in <code>stela_toolkit/lag_energy_spectrum.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LagEnergySpectrum</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the time lag as a function of energy between two sets of light curves or GP models.</span>

<span class="sd">    This class accepts lists of LightCurve objects or trained GaussianProcess models, one per energy bin.</span>
<span class="sd">    If the inputs are GP models, the most recently generated samples will be used automatically.</span>
<span class="sd">    If no samples are found, 1000 realizations will be generated on a 1000-point grid.</span>

<span class="sd">    Each light curve pair (one per energy bin) is used to compute a single lag by integrating the</span>
<span class="sd">    cross-spectrum over a specified frequency range. This yields one lag per energy bin, forming</span>
<span class="sd">    the lag-energy spectrum.</span>

<span class="sd">    A **positive lag** means that the time series in `lcs_or_models1` is **lagging behind**</span>
<span class="sd">    the corresponding series in `lcs_or_models2`.</span>

<span class="sd">    Coherence values are also computed for each energy bin to assess correlation strength,</span>
<span class="sd">    and noise bias correction can be applied to the coherence before estimating uncertainties.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lcs_or_models1 : list of LightCurve or GaussianProcess</span>
<span class="sd">        First set of inputs, one per energy bin.</span>
<span class="sd">    lcs_or_models2 : list of LightCurve or GaussianProcess</span>
<span class="sd">        Second set of inputs, matched to `lcs_or_models1`.</span>
<span class="sd">    fmin : float</span>
<span class="sd">        Minimum frequency to include when integrating.</span>
<span class="sd">    fmax : float</span>
<span class="sd">        Maximum frequency to include when integrating.</span>
<span class="sd">    bin_edges : array-like</span>
<span class="sd">        Edges of the energy bins corresponding to the light curves.</span>
<span class="sd">    subtract_coh_bias : bool, optional</span>
<span class="sd">        Whether to subtract the coherence noise bias before estimating lag uncertainties.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    energies : array-like</span>
<span class="sd">        Mean energy of each bin.</span>
<span class="sd">    energy_widths : array-like</span>
<span class="sd">        Half-width of each energy bin.</span>
<span class="sd">    lags : array-like</span>
<span class="sd">        Integrated time lag per energy bin.</span>
<span class="sd">    lag_errors : array-like</span>
<span class="sd">        Uncertainties in each lag value.</span>
<span class="sd">    cohs : array-like</span>
<span class="sd">        Coherence values per energy bin.</span>
<span class="sd">    coh_errors : array-like</span>
<span class="sd">        Uncertainties in the coherence values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">lcs_or_models1</span><span class="p">,</span>
                 <span class="n">lcs_or_models2</span><span class="p">,</span>
                 <span class="n">fmin</span><span class="p">,</span>
                 <span class="n">fmax</span><span class="p">,</span>
                 <span class="n">bin_edges</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">subtract_coh_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="c1"># leave main input check to LagFrequencySpectrum, check same input dimensions for now.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lcs_or_models1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lcs_or_models2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The lightcurves_or_models arrays must contain the sane number of lightcurve/model objects.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_models1</span> <span class="o">=</span> <span class="n">lcs_or_models1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_models2</span> <span class="o">=</span> <span class="n">lcs_or_models2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">energies</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">bin_edges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_widths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span>
        <span class="n">lag_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_lag_spectrum</span><span class="p">(</span><span class="n">subtract_coh_bias</span><span class="o">=</span><span class="n">subtract_coh_bias</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lag_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cohs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span> <span class="n">coh_errors</span> <span class="o">=</span> <span class="n">lag_spectrum</span>

    <span class="k">def</span> <span class="nf">compute_lag_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subtract_coh_bias</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the lag and coherence for each energy bin.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        subtract_coh_bias : bool</span>
<span class="sd">            Whether to subtract Poisson noise bias from the coherence.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lags : list</span>
<span class="sd">            List of integrated lags for each bin.</span>
<span class="sd">        lag_errors : list</span>
<span class="sd">            List of lag uncertainties.</span>
<span class="sd">        cohs : list</span>
<span class="sd">            List of mean coherence values.</span>
<span class="sd">        coh_errors : list</span>
<span class="sd">            List of coherence uncertainties.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">lags</span><span class="p">,</span> <span class="n">lag_errors</span><span class="p">,</span> <span class="n">cohs</span><span class="p">,</span> <span class="n">coh_errors</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_models1</span><span class="p">)):</span>
            <span class="n">lfs</span> <span class="o">=</span> <span class="n">LagFrequencySpectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_models1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">data_models2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                       <span class="n">fmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span>
                                       <span class="n">fmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span>
                                       <span class="n">num_bins</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                       <span class="n">subtract_coh_bias</span><span class="o">=</span><span class="n">subtract_coh_bias</span><span class="p">,</span>
                                       <span class="p">)</span>
            <span class="n">lags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lfs</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span>
            <span class="n">lag_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lfs</span><span class="o">.</span><span class="n">lag_errors</span><span class="p">)</span>
            <span class="n">cohs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lfs</span><span class="o">.</span><span class="n">cohs</span><span class="p">)</span>
            <span class="n">coh_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lfs</span><span class="o">.</span><span class="n">coh_errors</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">lags</span><span class="p">,</span> <span class="n">lag_errors</span><span class="p">,</span> <span class="n">cohs</span><span class="p">,</span> <span class="n">coh_errors</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">energy_widths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lag_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cohs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coh_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the lag-energy spectrum and associated coherence values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Keyword arguments for customizing the plot (e.g., xlabel, xscale, yscale).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">energies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energies</span> <span class="k">if</span> <span class="n">energies</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">energies</span>
        <span class="n">energy_widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_widths</span> <span class="k">if</span> <span class="n">energy_widths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">energy_widths</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="k">if</span> <span class="n">lags</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">lags</span>
        <span class="n">lag_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lag_errors</span> <span class="k">if</span> <span class="n">lag_errors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">lag_errors</span>
        <span class="n">cohs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cohs</span> <span class="k">if</span> <span class="n">cohs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">cohs</span>
        <span class="n">coh_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coh_errors</span> <span class="k">if</span> <span class="n">coh_errors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">coh_errors</span>

        <span class="n">figsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Time Lag&#39;</span><span class="p">)</span>
        <span class="n">xscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">yscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;yscale&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

        <span class="c1"># Lag-energy spectrum</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">energy_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">lag_errors</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="c1"># Coherence spectrum</span>
        <span class="k">if</span> <span class="n">cohs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">coh_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">cohs</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">energy_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">coh_errors</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Coherence&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">count_frequencies_in_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts the number of frequencies in each frequency bin.</span>
<span class="sd">        Wrapper method to use FrequencyBinning.count_frequencies_in_bins with class attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">count_frequencies_in_bins</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="n">bin_edges</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_lag_spectrum</span><span class="p">(</span><span class="n">subtract_coh_bias</span><span class="p">)</span></code>

<a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the lag and coherence for each energy bin.</p>
<h5 id="stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum--parameters">Parameters<a class="headerlink" href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum--parameters" title="Permanent link">&para;</a></h5>
<p>subtract_coh_bias : bool
    Whether to subtract Poisson noise bias from the coherence.</p>
<h5 id="stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum--returns">Returns<a class="headerlink" href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.compute_lag_spectrum--returns" title="Permanent link">&para;</a></h5>
<p>lags : list
    List of integrated lags for each bin.
lag_errors : list
    List of lag uncertainties.
cohs : list
    List of mean coherence values.
coh_errors : list
    List of coherence uncertainties.</p>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/lag_energy_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_lag_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subtract_coh_bias</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the lag and coherence for each energy bin.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    subtract_coh_bias : bool</span>
<span class="sd">        Whether to subtract Poisson noise bias from the coherence.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lags : list</span>
<span class="sd">        List of integrated lags for each bin.</span>
<span class="sd">    lag_errors : list</span>
<span class="sd">        List of lag uncertainties.</span>
<span class="sd">    cohs : list</span>
<span class="sd">        List of mean coherence values.</span>
<span class="sd">    coh_errors : list</span>
<span class="sd">        List of coherence uncertainties.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lags</span><span class="p">,</span> <span class="n">lag_errors</span><span class="p">,</span> <span class="n">cohs</span><span class="p">,</span> <span class="n">coh_errors</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_models1</span><span class="p">)):</span>
        <span class="n">lfs</span> <span class="o">=</span> <span class="n">LagFrequencySpectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_models1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">data_models2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                   <span class="n">fmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span>
                                   <span class="n">fmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span>
                                   <span class="n">num_bins</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                   <span class="n">subtract_coh_bias</span><span class="o">=</span><span class="n">subtract_coh_bias</span><span class="p">,</span>
                                   <span class="p">)</span>
        <span class="n">lags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lfs</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span>
        <span class="n">lag_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lfs</span><span class="o">.</span><span class="n">lag_errors</span><span class="p">)</span>
        <span class="n">cohs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lfs</span><span class="o">.</span><span class="n">cohs</span><span class="p">)</span>
        <span class="n">coh_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lfs</span><span class="o">.</span><span class="n">coh_errors</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lags</span><span class="p">,</span> <span class="n">lag_errors</span><span class="p">,</span> <span class="n">cohs</span><span class="p">,</span> <span class="n">coh_errors</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.count_frequencies_in_bins" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">count_frequencies_in_bins</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.count_frequencies_in_bins" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Counts the number of frequencies in each frequency bin.
Wrapper method to use FrequencyBinning.count_frequencies_in_bins with class attributes.</p>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/lag_energy_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">count_frequencies_in_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counts the number of frequencies in each frequency bin.</span>
<span class="sd">    Wrapper method to use FrequencyBinning.count_frequencies_in_bins with class attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">count_frequencies_in_bins</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="n">bin_edges</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">energies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">energy_widths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lag_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cohs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coh_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.plot" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the lag-energy spectrum and associated coherence values.</p>
<h5 id="stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.plot--parameters">Parameters<a class="headerlink" href="#stela_toolkit.lag_energy_spectrum.LagEnergySpectrum.plot--parameters" title="Permanent link">&para;</a></h5>
<p>**kwargs : dict
    Keyword arguments for customizing the plot (e.g., xlabel, xscale, yscale).</p>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/lag_energy_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">energy_widths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lag_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cohs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coh_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the lag-energy spectrum and associated coherence values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Keyword arguments for customizing the plot (e.g., xlabel, xscale, yscale).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energies</span> <span class="k">if</span> <span class="n">energies</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">energies</span>
    <span class="n">energy_widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_widths</span> <span class="k">if</span> <span class="n">energy_widths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">energy_widths</span>
    <span class="n">lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="k">if</span> <span class="n">lags</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">lags</span>
    <span class="n">lag_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lag_errors</span> <span class="k">if</span> <span class="n">lag_errors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">lag_errors</span>
    <span class="n">cohs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cohs</span> <span class="k">if</span> <span class="n">cohs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">cohs</span>
    <span class="n">coh_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coh_errors</span> <span class="k">if</span> <span class="n">coh_errors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">coh_errors</span>

    <span class="n">figsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">xlabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
    <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Time Lag&#39;</span><span class="p">)</span>
    <span class="n">xscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">yscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;yscale&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

    <span class="c1"># Lag-energy spectrum</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">energy_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">lag_errors</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="c1"># Coherence spectrum</span>
    <span class="k">if</span> <span class="n">cohs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">coh_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">cohs</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">energy_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">coh_errors</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Coherence&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>