
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tools for interpolating astrophysical light curves using Gaussian Processes in order to compute frequency-domain and standard time domain data products">
      
      
      
      
        <link rel="prev" href="../plot/">
      
      
        <link rel="next" href="../preprocessing/">
      
      
      <link rel="icon" href="../../assets/stela_logo_sq.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Power Spectrum - STELA Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#power_spectrum" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="STELA Toolkit" class="md-header__button md-logo" aria-label="STELA Toolkit" data-md-component="logo">
      
  <img src="../../assets/stela_logo_sq.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            STELA Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Power Spectrum
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="STELA Toolkit" class="md-nav__button md-logo" aria-label="STELA Toolkit" data-md-component="logo">
      
  <img src="../../assets/stela_logo_sq.png" alt="logo">

    </a>
    STELA Toolkit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gaussian_process_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian Processes
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Module Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Module Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coherence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coherence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cross_correlation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cross Correlation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cross_spectrum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cross Spectrum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_simulator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Simulator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frequency_binning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Frequency Binning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gaussian_process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lag_energy_spectrum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lag Energy Spectrum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lag_frequency_spectrum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lag Frequency Spectrum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plotting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Power Spectrum
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Power Spectrum
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      power_spectrum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum" class="md-nav__link">
    <span class="md-ellipsis">
      PowerSpectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PowerSpectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_power_spectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_power_spectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_stacked_power_spectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_stacked_power_spectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.count_frequencies_in_bins" class="md-nav__link">
    <span class="md-ellipsis">
      count_frequencies_in_bins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preprocessing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_13" >
        
          
          <label class="md-nav__link" for="__nav_6_13" id="__nav_6_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Internal
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_13">
            <span class="md-nav__icon md-icon"></span>
            Internal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../check_inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    _CheckInputs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clarify_warnings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    _ClearWarnings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      power_spectrum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum" class="md-nav__link">
    <span class="md-ellipsis">
      PowerSpectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PowerSpectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_power_spectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_power_spectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_stacked_power_spectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_stacked_power_spectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.count_frequencies_in_bins" class="md-nav__link">
    <span class="md-ellipsis">
      count_frequencies_in_bins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.power_spectrum.PowerSpectrum.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="power_spectrum">power_spectrum<a class="headerlink" href="#power_spectrum" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="stela_toolkit.power_spectrum"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="stela_toolkit.power_spectrum.PowerSpectrum" class="doc doc-heading">
            <code>PowerSpectrum</code>


<a href="#stela_toolkit.power_spectrum.PowerSpectrum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Compute the power spectrum of a light curve using the FFT.</p>
<p>This class accepts either a STELA LightCurve object or a trained GaussianProcess model.
If a GaussianProcess is passed, the most recently generated samples are used. 
If no samples exist, the toolkit will automatically generate 1000 posterior realizations
on a 1000-point grid.</p>
<p>For single light curves, the FFT is applied directly to the time series.
For GP models, the power spectrum is computed for each sampled realization,
and the mean and standard deviation across all samples are returned.</p>
<p>Power spectra are computed in variance units by default (i.e., normalized to units
of squared flux), allowing for direct interpretation in the context of variability
amplitude and fractional RMS.</p>
<p>Frequency binning is supported via linear, logarithmic, or user-defined bins.</p>
<h4 id="stela_toolkit.power_spectrum.PowerSpectrum--parameters">Parameters<a class="headerlink" href="#stela_toolkit.power_spectrum.PowerSpectrum--parameters" title="Permanent link">&para;</a></h4>
<p>lc_or_model : LightCurve or GaussianProcess
    Input light curve or trained GP model.
fmin : float or 'auto', optional
    Minimum frequency to include. If 'auto', uses the lowest nonzero FFT frequency.
fmax : float or 'auto', optional
    Maximum frequency to include. If 'auto', uses the Nyquist frequency.
num_bins : int, optional
    Number of frequency bins.
bin_type : str, optional
    Binning type: 'log' or 'linear'.
bin_edges : array-like, optional
    Custom bin edges (overrides <code>num_bins</code> and <code>bin_type</code>).
norm : bool, optional
    Whether to normalize the power spectrum to variance units (i.e., PSD units).</p>
<h4 id="stela_toolkit.power_spectrum.PowerSpectrum--attributes">Attributes<a class="headerlink" href="#stela_toolkit.power_spectrum.PowerSpectrum--attributes" title="Permanent link">&para;</a></h4>
<p>freqs : array-like
    Center frequencies of each bin.
freq_widths : array-like
    Bin widths for each frequency bin.
powers : array-like
    Power spectrum values (or mean if using GP samples).
power_errors : array-like
    Uncertainties in the power spectrum (std across GP samples if applicable).</p>







              <details class="quote">
                <summary>Source code in <code>stela_toolkit/power_spectrum.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PowerSpectrum</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the power spectrum of a light curve using the FFT.</span>

<span class="sd">    This class accepts either a STELA LightCurve object or a trained GaussianProcess model.</span>
<span class="sd">    If a GaussianProcess is passed, the most recently generated samples are used. </span>
<span class="sd">    If no samples exist, the toolkit will automatically generate 1000 posterior realizations</span>
<span class="sd">    on a 1000-point grid.</span>

<span class="sd">    For single light curves, the FFT is applied directly to the time series.</span>
<span class="sd">    For GP models, the power spectrum is computed for each sampled realization,</span>
<span class="sd">    and the mean and standard deviation across all samples are returned.</span>

<span class="sd">    Power spectra are computed in variance units by default (i.e., normalized to units</span>
<span class="sd">    of squared flux), allowing for direct interpretation in the context of variability</span>
<span class="sd">    amplitude and fractional RMS.</span>

<span class="sd">    Frequency binning is supported via linear, logarithmic, or user-defined bins.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lc_or_model : LightCurve or GaussianProcess</span>
<span class="sd">        Input light curve or trained GP model.</span>
<span class="sd">    fmin : float or &#39;auto&#39;, optional</span>
<span class="sd">        Minimum frequency to include. If &#39;auto&#39;, uses the lowest nonzero FFT frequency.</span>
<span class="sd">    fmax : float or &#39;auto&#39;, optional</span>
<span class="sd">        Maximum frequency to include. If &#39;auto&#39;, uses the Nyquist frequency.</span>
<span class="sd">    num_bins : int, optional</span>
<span class="sd">        Number of frequency bins.</span>
<span class="sd">    bin_type : str, optional</span>
<span class="sd">        Binning type: &#39;log&#39; or &#39;linear&#39;.</span>
<span class="sd">    bin_edges : array-like, optional</span>
<span class="sd">        Custom bin edges (overrides `num_bins` and `bin_type`).</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        Whether to normalize the power spectrum to variance units (i.e., PSD units).</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    freqs : array-like</span>
<span class="sd">        Center frequencies of each bin.</span>
<span class="sd">    freq_widths : array-like</span>
<span class="sd">        Bin widths for each frequency bin.</span>
<span class="sd">    powers : array-like</span>
<span class="sd">        Power spectrum values (or mean if using GP samples).</span>
<span class="sd">    power_errors : array-like</span>
<span class="sd">        Uncertainties in the power spectrum (std across GP samples if applicable).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">lc_or_model</span><span class="p">,</span>
                 <span class="n">fmin</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                 <span class="n">fmax</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                 <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">bin_type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
                 <span class="n">bin_edges</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="c1"># To do: ValueError for norm=True acting on mean=0 (standardized data)</span>
        <span class="n">input_data</span> <span class="o">=</span> <span class="n">_CheckInputs</span><span class="o">.</span><span class="n">_check_lightcurve_or_model</span><span class="p">(</span><span class="n">lc_or_model</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
        <span class="n">_CheckInputs</span><span class="o">.</span><span class="n">_check_input_bins</span><span class="p">(</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">)</span>

        <span class="c1"># Use absolute min and max frequencies if set to &#39;auto&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">fmin</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span> <span class="k">else</span> <span class="n">fmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">fmax</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span> <span class="k">else</span> <span class="n">fmax</span>  <span class="c1"># nyquist frequency</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span> <span class="o">=</span> <span class="n">num_bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span> <span class="o">=</span> <span class="n">bin_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span> <span class="o">=</span> <span class="n">bin_edges</span>

        <span class="c1"># if multiple light curve are provided, compute the stacked power spectrum</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">power_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_stacked_power_spectrum</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">power_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_power_spectrum</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">freqs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_widths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">power_errors</span> <span class="o">=</span> <span class="n">power_spectrum</span>

    <span class="k">def</span> <span class="nf">compute_power_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the power spectrum for a single light curve.</span>

<span class="sd">        Applies the FFT to the light curve and optionally normalizes the result</span>
<span class="sd">        to variance (PSD) units. If binning is enabled, returns binned power.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        times : array-like, optional</span>
<span class="sd">            Time array to use (defaults to internal value).</span>
<span class="sd">        rates : array-like, optional</span>
<span class="sd">            Rate array to use (defaults to internal value).</span>
<span class="sd">        norm : bool, optional</span>
<span class="sd">            Whether to normalize to variance units.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        freqs : array-like</span>
<span class="sd">            Frequencies of the power spectrum.</span>
<span class="sd">        freq_widths : array-like or None</span>
<span class="sd">            Bin widths (if binned).</span>
<span class="sd">        powers : array-like</span>
<span class="sd">            Power spectrum values.</span>
<span class="sd">        power_errors : array-like or None</span>
<span class="sd">            Power spectrum uncertainties (if binned).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="k">if</span> <span class="n">times</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">times</span>
        <span class="n">rates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates</span> <span class="k">if</span> <span class="n">rates</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rates</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span>

        <span class="n">freqs</span><span class="p">,</span> <span class="n">fft</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">rates</span><span class="p">)</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
        <span class="n">powers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="c1"># Filter frequencies within [fmin, fmax]</span>
        <span class="n">valid_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">freqs</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">)</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span>
        <span class="n">powers</span> <span class="o">=</span> <span class="n">powers</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
            <span class="n">powers</span> <span class="o">/=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># Apply binning</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span><span class="p">:</span>
                <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">define_bins</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">,</span> 
                                                         <span class="n">bin_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span>
                                                        <span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">:</span>
                <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">define_bins</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either num_bins or bin_edges must be provided.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                 <span class="s2">&quot;In other words, you must specify the number of bins or the bin edges.&quot;</span><span class="p">)</span>

            <span class="n">binned_power</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">bin_data</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">)</span>
            <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">power_errors</span> <span class="o">=</span> <span class="n">binned_power</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">freq_widths</span><span class="p">,</span> <span class="n">power_errors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">power_errors</span>

    <span class="k">def</span> <span class="nf">compute_stacked_power_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute power spectrum for each GP sample and return the mean and std.</span>
<span class="sd">        This method is used automatically when a GP model with samples is passed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        norm : bool, optional</span>
<span class="sd">            Whether to normalize to variance units.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        freqs : array-like</span>
<span class="sd">            Frequencies of the power spectrum.</span>
<span class="sd">        freq_widths : array-like</span>
<span class="sd">            Widths of frequency bins.</span>
<span class="sd">        power_mean : array-like</span>
<span class="sd">            Mean power spectrum values.</span>
<span class="sd">        power_std : array-like</span>
<span class="sd">            Standard deviation of power values across realizations.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">powers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">power_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_power_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
            <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">power_spectrum</span>
            <span class="n">powers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>

        <span class="c1"># Stack the collected powers and errors</span>
        <span class="n">powers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">powers</span><span class="p">)</span>
        <span class="n">power_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">powers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">power_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">powers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">power_mean</span><span class="p">,</span> <span class="n">power_std</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq_widths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">powers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">power_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the power spectrum.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Custom plotting options (xlabel, yscale, etc.).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freqs</span> <span class="k">if</span> <span class="n">freqs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">freqs</span>
        <span class="n">freq_widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_widths</span> <span class="k">if</span> <span class="n">freq_widths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">freq_widths</span>
        <span class="n">powers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="k">if</span> <span class="n">powers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">powers</span>
        <span class="n">power_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power_errors</span> <span class="k">if</span> <span class="n">power_errors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">power_errors</span>

        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Power&#39;</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;xscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;yscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">Plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">freqs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">powers</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">freq_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">power_errors</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">count_frequencies_in_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts the number of frequencies in each frequency bin.</span>
<span class="sd">        Wrapper method to use FrequencyBinning.count_frequencies_in_bins with class attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">count_frequencies_in_bins</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="n">bin_edges</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_power_spectrum</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the power spectrum for a single light curve.</p>
<p>Applies the FFT to the light curve and optionally normalizes the result
to variance (PSD) units. If binning is enabled, returns binned power.</p>
<h5 id="stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum--parameters">Parameters<a class="headerlink" href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum--parameters" title="Permanent link">&para;</a></h5>
<p>times : array-like, optional
    Time array to use (defaults to internal value).
rates : array-like, optional
    Rate array to use (defaults to internal value).
norm : bool, optional
    Whether to normalize to variance units.</p>
<h5 id="stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum--returns">Returns<a class="headerlink" href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_power_spectrum--returns" title="Permanent link">&para;</a></h5>
<p>freqs : array-like
    Frequencies of the power spectrum.
freq_widths : array-like or None
    Bin widths (if binned).
powers : array-like
    Power spectrum values.
power_errors : array-like or None
    Power spectrum uncertainties (if binned).</p>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/power_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_power_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the power spectrum for a single light curve.</span>

<span class="sd">    Applies the FFT to the light curve and optionally normalizes the result</span>
<span class="sd">    to variance (PSD) units. If binning is enabled, returns binned power.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    times : array-like, optional</span>
<span class="sd">        Time array to use (defaults to internal value).</span>
<span class="sd">    rates : array-like, optional</span>
<span class="sd">        Rate array to use (defaults to internal value).</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        Whether to normalize to variance units.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    freqs : array-like</span>
<span class="sd">        Frequencies of the power spectrum.</span>
<span class="sd">    freq_widths : array-like or None</span>
<span class="sd">        Bin widths (if binned).</span>
<span class="sd">    powers : array-like</span>
<span class="sd">        Power spectrum values.</span>
<span class="sd">    power_errors : array-like or None</span>
<span class="sd">        Power spectrum uncertainties (if binned).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="k">if</span> <span class="n">times</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">times</span>
    <span class="n">rates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates</span> <span class="k">if</span> <span class="n">rates</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rates</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span>

    <span class="n">freqs</span><span class="p">,</span> <span class="n">fft</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">rates</span><span class="p">)</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
    <span class="n">powers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="c1"># Filter frequencies within [fmin, fmax]</span>
    <span class="n">valid_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">freqs</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">)</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span>
    <span class="n">powers</span> <span class="o">=</span> <span class="n">powers</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
        <span class="n">powers</span> <span class="o">/=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

    <span class="c1"># Apply binning</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span><span class="p">:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span><span class="p">:</span>
            <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">define_bins</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">,</span> 
                                                     <span class="n">bin_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span>
                                                    <span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">:</span>
            <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">define_bins</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either num_bins or bin_edges must be provided.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;In other words, you must specify the number of bins or the bin edges.&quot;</span><span class="p">)</span>

        <span class="n">binned_power</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">bin_data</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">)</span>
        <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">power_errors</span> <span class="o">=</span> <span class="n">binned_power</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">freq_widths</span><span class="p">,</span> <span class="n">power_errors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">power_errors</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_stacked_power_spectrum</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute power spectrum for each GP sample and return the mean and std.
This method is used automatically when a GP model with samples is passed.</p>
<h5 id="stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum--parameters">Parameters<a class="headerlink" href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum--parameters" title="Permanent link">&para;</a></h5>
<p>norm : bool, optional
    Whether to normalize to variance units.</p>
<h5 id="stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum--returns">Returns<a class="headerlink" href="#stela_toolkit.power_spectrum.PowerSpectrum.compute_stacked_power_spectrum--returns" title="Permanent link">&para;</a></h5>
<p>freqs : array-like
    Frequencies of the power spectrum.
freq_widths : array-like
    Widths of frequency bins.
power_mean : array-like
    Mean power spectrum values.
power_std : array-like
    Standard deviation of power values across realizations.</p>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/power_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_stacked_power_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute power spectrum for each GP sample and return the mean and std.</span>
<span class="sd">    This method is used automatically when a GP model with samples is passed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        Whether to normalize to variance units.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    freqs : array-like</span>
<span class="sd">        Frequencies of the power spectrum.</span>
<span class="sd">    freq_widths : array-like</span>
<span class="sd">        Widths of frequency bins.</span>
<span class="sd">    power_mean : array-like</span>
<span class="sd">        Mean power spectrum values.</span>
<span class="sd">    power_std : array-like</span>
<span class="sd">        Standard deviation of power values across realizations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">powers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">power_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_power_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
        <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">power_spectrum</span>
        <span class="n">powers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>

    <span class="c1"># Stack the collected powers and errors</span>
    <span class="n">powers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">powers</span><span class="p">)</span>
    <span class="n">power_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">powers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">power_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">powers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">power_mean</span><span class="p">,</span> <span class="n">power_std</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.power_spectrum.PowerSpectrum.count_frequencies_in_bins" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">count_frequencies_in_bins</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#stela_toolkit.power_spectrum.PowerSpectrum.count_frequencies_in_bins" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Counts the number of frequencies in each frequency bin.
Wrapper method to use FrequencyBinning.count_frequencies_in_bins with class attributes.</p>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/power_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">count_frequencies_in_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counts the number of frequencies in each frequency bin.</span>
<span class="sd">    Wrapper method to use FrequencyBinning.count_frequencies_in_bins with class attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">count_frequencies_in_bins</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="n">bin_edges</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.power_spectrum.PowerSpectrum.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq_widths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">powers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">power_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#stela_toolkit.power_spectrum.PowerSpectrum.plot" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the power spectrum.</p>
<h5 id="stela_toolkit.power_spectrum.PowerSpectrum.plot--parameters">Parameters<a class="headerlink" href="#stela_toolkit.power_spectrum.PowerSpectrum.plot--parameters" title="Permanent link">&para;</a></h5>
<p>**kwargs : dict
    Custom plotting options (xlabel, yscale, etc.).</p>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/power_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq_widths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">powers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">power_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the power spectrum.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Custom plotting options (xlabel, yscale, etc.).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freqs</span> <span class="k">if</span> <span class="n">freqs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">freqs</span>
    <span class="n">freq_widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_widths</span> <span class="k">if</span> <span class="n">freq_widths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">freq_widths</span>
    <span class="n">powers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="k">if</span> <span class="n">powers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">powers</span>
    <span class="n">power_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power_errors</span> <span class="k">if</span> <span class="n">power_errors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">power_errors</span>

    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Power&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;xscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;yscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">Plotter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">freqs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">powers</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">freq_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">power_errors</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>