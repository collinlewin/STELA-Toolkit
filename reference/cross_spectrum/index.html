
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tools for interpolating astrophysical light curves using Gaussian Processes in order to compute frequency-domain and standard time domain data products">
      
      
      
      
        <link rel="prev" href="../cross_correlation/">
      
      
        <link rel="next" href="../data_loader/">
      
      
      <link rel="icon" href="../../assets/stela_logo_sq.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Cross Spectrum - STELA Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Saira:wght@400;600;700&display=swap">
    
      <link rel="stylesheet" href="../../styles/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cross_spectrum" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="STELA Toolkit" class="md-header__button md-logo" aria-label="STELA Toolkit" data-md-component="logo">
      
  <img src="../../assets/stela_logo_sq.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            STELA Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cross Spectrum
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../overview/" class="md-tabs__link">
        
  
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../gaussian_process_intro/" class="md-tabs__link">
        
  
  
    
  
  Gaussian Processes

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorial/" class="md-tabs__link">
        
  
  
    
  
  Tutorial

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../coherence/" class="md-tabs__link">
          
  
  
  Class Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="STELA Toolkit" class="md-nav__button md-logo" aria-label="STELA Toolkit" data-md-component="logo">
      
  <img src="../../assets/stela_logo_sq.png" alt="logo">

    </a>
    STELA Toolkit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gaussian_process_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian Processes
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Class Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Class Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coherence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coherence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cross_correlation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cross Correlation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Cross Spectrum
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Cross Spectrum
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      cross_spectrum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum" class="md-nav__link">
    <span class="md-ellipsis">
      CrossSpectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CrossSpectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum.compute_cross_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_cross_spectrum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum.compute_stacked_cross_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_stacked_cross_spectrum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum.count_frequencies_in_bins" class="md-nav__link">
    <span class="md-ellipsis">
      count_frequencies_in_bins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_simulator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Simulator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gaussian_process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lag_energy_spectrum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lag Energy Spectrum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lag_frequency_spectrum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lag Frequency Spectrum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../power_spectrum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Power Spectrum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preprocessing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_11" >
        
          
          <label class="md-nav__link" for="__nav_6_11" id="__nav_6_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Internal
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_11">
            <span class="md-nav__icon md-icon"></span>
            Internal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frequency_binning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Frequency Binning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plotting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../check_inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    _CheckInputs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clarify_warnings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    _ClearWarnings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      cross_spectrum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum" class="md-nav__link">
    <span class="md-ellipsis">
      CrossSpectrum
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CrossSpectrum">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum.compute_cross_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_cross_spectrum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum.compute_stacked_cross_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      compute_stacked_cross_spectrum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum.count_frequencies_in_bins" class="md-nav__link">
    <span class="md-ellipsis">
      count_frequencies_in_bins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stela_toolkit.cross_spectrum.CrossSpectrum.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cross_spectrum">cross_spectrum<a class="headerlink" href="#cross_spectrum" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="stela_toolkit.cross_spectrum"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="stela_toolkit.cross_spectrum.CrossSpectrum" class="doc doc-heading">
            <code>CrossSpectrum</code>


<a href="#stela_toolkit.cross_spectrum.CrossSpectrum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Compute the cross-spectrum between two light curves or trained Gaussian Process models.</p>
<p>This class accepts LightCurve objects or GaussianProcess models from this package.
For GP models, if posterior samples have already been generated, those are used.
If not, the class automatically generates 1000 samples across a 1000-point grid.</p>
<p>The cross-spectrum is computed using the Fourier transform of one time series
multiplied by the complex conjugate of the other, yielding frequency-dependent phase
and amplitude information.</p>
<p>If both inputs are GP models, the cross-spectrum is computed across all sample pairs,
and the mean and standard deviation across realizations are returned.</p>
<p>Frequency binning is available with options for logarithmic, linear, or custom spacing.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lc_or_model1</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="LightCurve (stela_toolkit.data_loader.LightCurve)" href="../data_loader/#stela_toolkit.data_loader.LightCurve">LightCurve</a> or <a class="autorefs autorefs-internal" title="GaussianProcess (stela_toolkit.gaussian_process.GaussianProcess)" href="../gaussian_process/#stela_toolkit.gaussian_process.GaussianProcess">GaussianProcess</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First input light curve or trained GP model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lc_or_model2</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="LightCurve (stela_toolkit.data_loader.LightCurve)" href="../data_loader/#stela_toolkit.data_loader.LightCurve">LightCurve</a> or <a class="autorefs autorefs-internal" title="GaussianProcess (stela_toolkit.gaussian_process.GaussianProcess)" href="../gaussian_process/#stela_toolkit.gaussian_process.GaussianProcess">GaussianProcess</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second input light curve or trained GP model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fmin</code>
            </td>
            <td>
                  <code><span title="float">float</span> or <span title="auto">auto</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum frequency to include. If 'auto', uses lowest nonzero FFT frequency.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fmax</code>
            </td>
            <td>
                  <code><span title="float">float</span> or <span title="auto">auto</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum frequency to include. If 'auto', uses the Nyquist frequency.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_bins</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of frequency bins.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bin_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binning type: 'log' or 'linear'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;log&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bin_edges</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom frequency bin edges. Overrides <code>num_bins</code> and <code>bin_type</code> if provided.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>norm</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to normalize the cross-spectrum to variance units (i.e., PSD units).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="stela_toolkit.cross_spectrum.CrossSpectrum.freqs">freqs</span></code></td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequency bin centers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="stela_toolkit.cross_spectrum.CrossSpectrum.freq_widths">freq_widths</span></code></td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequency bin widths.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="stela_toolkit.cross_spectrum.CrossSpectrum.cs">cs</span></code></td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Complex cross-spectrum values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="stela_toolkit.cross_spectrum.CrossSpectrum.cs_errors">cs_errors</span></code></td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Uncertainties in the binned cross-spectrum (if stacked).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>stela_toolkit/cross_spectrum.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CrossSpectrum</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the cross-spectrum between two light curves or trained Gaussian Process models.</span>

<span class="sd">    This class accepts LightCurve objects or GaussianProcess models from this package.</span>
<span class="sd">    For GP models, if posterior samples have already been generated, those are used.</span>
<span class="sd">    If not, the class automatically generates 1000 samples across a 1000-point grid.</span>

<span class="sd">    The cross-spectrum is computed using the Fourier transform of one time series</span>
<span class="sd">    multiplied by the complex conjugate of the other, yielding frequency-dependent phase</span>
<span class="sd">    and amplitude information.</span>

<span class="sd">    If both inputs are GP models, the cross-spectrum is computed across all sample pairs,</span>
<span class="sd">    and the mean and standard deviation across realizations are returned.</span>

<span class="sd">    Frequency binning is available with options for logarithmic, linear, or custom spacing.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lc_or_model1 : LightCurve or GaussianProcess</span>
<span class="sd">        First input light curve or trained GP model.</span>

<span class="sd">    lc_or_model2 : LightCurve or GaussianProcess</span>
<span class="sd">        Second input light curve or trained GP model.</span>

<span class="sd">    fmin : float or &#39;auto&#39;, optional</span>
<span class="sd">        Minimum frequency to include. If &#39;auto&#39;, uses lowest nonzero FFT frequency.</span>

<span class="sd">    fmax : float or &#39;auto&#39;, optional</span>
<span class="sd">        Maximum frequency to include. If &#39;auto&#39;, uses the Nyquist frequency.</span>

<span class="sd">    num_bins : int, optional</span>
<span class="sd">        Number of frequency bins.</span>

<span class="sd">    bin_type : str, optional</span>
<span class="sd">        Binning type: &#39;log&#39; or &#39;linear&#39;.</span>

<span class="sd">    bin_edges : array-like, optional</span>
<span class="sd">        Custom frequency bin edges. Overrides `num_bins` and `bin_type` if provided.</span>

<span class="sd">    norm : bool, optional</span>
<span class="sd">        Whether to normalize the cross-spectrum to variance units (i.e., PSD units).</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    freqs : array-like</span>
<span class="sd">        Frequency bin centers.</span>

<span class="sd">    freq_widths : array-like</span>
<span class="sd">        Frequency bin widths.</span>

<span class="sd">    cs : array-like</span>
<span class="sd">        Complex cross-spectrum values.</span>

<span class="sd">    cs_errors : array-like</span>
<span class="sd">        Uncertainties in the binned cross-spectrum (if stacked).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">lc_or_model1</span><span class="p">,</span>
                 <span class="n">lc_or_model2</span><span class="p">,</span>
                 <span class="n">fmin</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                 <span class="n">fmax</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                 <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">bin_type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
                 <span class="n">bin_edges</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="c1"># To do: update main docstring</span>
        <span class="n">input_data</span> <span class="o">=</span> <span class="n">_CheckInputs</span><span class="o">.</span><span class="n">_check_lightcurve_or_model</span><span class="p">(</span><span class="n">lc_or_model1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">times1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates1</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">times1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>

        <span class="n">input_data</span> <span class="o">=</span> <span class="n">_CheckInputs</span><span class="o">.</span><span class="n">_check_lightcurve_or_model</span><span class="p">(</span><span class="n">lc_or_model2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">times2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates2</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">times2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>

        <span class="n">_CheckInputs</span><span class="o">.</span><span class="n">_check_input_bins</span><span class="p">(</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">times2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The time arrays of the two light curves must be identical.&quot;</span><span class="p">)</span>

        <span class="c1"># Use absolute min and max frequencies if set to &#39;auto&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates1</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">fmin</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span> <span class="k">else</span> <span class="n">fmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates1</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">fmax</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span> <span class="k">else</span> <span class="n">fmax</span>  <span class="c1"># nyquist frequency</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span> <span class="o">=</span> <span class="n">num_bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span> <span class="o">=</span> <span class="n">bin_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span> <span class="o">=</span> <span class="n">bin_edges</span>

        <span class="c1"># Check if the input rates are for multiple realizations</span>
        <span class="c1"># this needs to be corrected for handling different shapes and dim val1 != dim val2</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">cross_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_stacked_cross_spectrum</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cross_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_cross_spectrum</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">freqs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_widths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cs_errors</span> <span class="o">=</span> <span class="n">cross_spectrum</span>

    <span class="k">def</span> <span class="nf">compute_cross_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">times1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rates1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">times2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rates2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the cross-spectrum for a single pair of light curves.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        times1 : array-like, optional</span>
<span class="sd">            Time values for the first light curve.</span>

<span class="sd">        rates1 : array-like, optional</span>
<span class="sd">            Flux or count rate values for the first light curve.</span>

<span class="sd">        times2 : array-like, optional</span>
<span class="sd">            Time values for the second light curve.</span>

<span class="sd">        rates2 : array-like, optional</span>
<span class="sd">            Flux or count rate values for the second light curve.</span>

<span class="sd">        norm : bool, optional</span>
<span class="sd">            Whether to normalize the result to power spectral density units.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        freqs : array-like</span>
<span class="sd">            Frequencies at which the cross-spectrum is evaluated.</span>

<span class="sd">        freq_widths : array-like</span>
<span class="sd">            Widths of frequency bins (for error bars or plotting).</span>

<span class="sd">        cross_spectrum : array-like</span>
<span class="sd">            Complex cross-spectrum values for each frequency bin.</span>

<span class="sd">        cross_spectrum_errors : array-like or None</span>
<span class="sd">            Uncertainties in the binned cross-spectrum values. None if unbinned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">times1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times1</span> <span class="k">if</span> <span class="n">times1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">times1</span>
        <span class="n">rates1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates1</span> <span class="k">if</span> <span class="n">rates1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rates1</span>
        <span class="n">times2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times2</span> <span class="k">if</span> <span class="n">times2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">times2</span>
        <span class="n">rates2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates2</span> <span class="k">if</span> <span class="n">rates2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rates2</span>

        <span class="n">freqs</span><span class="p">,</span> <span class="n">fft1</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times1</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">rates1</span><span class="p">)</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">fft2</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times2</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">rates2</span><span class="p">)</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>

        <span class="n">cross_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">fft1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fft2</span>

        <span class="c1"># Filter frequencies within [fmin, fmax]</span>
        <span class="n">valid_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">freqs</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">)</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span>
        <span class="n">cross_spectrum</span> <span class="o">=</span> <span class="n">cross_spectrum</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span>

        <span class="c1"># Normalize power spectrum to units of variance (PSD)</span>
        <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rates1</span><span class="p">)</span>
            <span class="n">norm_factor</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rates1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rates2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
            <span class="n">cross_spectrum</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">)</span>

        <span class="c1"># Apply binning</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span><span class="p">:</span>
                <span class="c1"># use custom bin edges</span>
                <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">define_bins</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">,</span>
                    <span class="n">bin_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">:</span>
                <span class="c1"># use equal-width bins in log or linear space</span>
                <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">define_bins</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either num_bins or bin_edges must be provided.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                 <span class="s2">&quot;In other words, you must specify the number of bins or the bin edges.&quot;</span><span class="p">)</span>

            <span class="n">binned_cross_spectrum</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">bin_data</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cross_spectrum</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">)</span>
            <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">cross_spectrum</span><span class="p">,</span> <span class="n">cross_spectrum_errors</span> <span class="o">=</span> <span class="n">binned_cross_spectrum</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">freq_widths</span><span class="p">,</span> <span class="n">cross_spectrum_errors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">cross_spectrum</span><span class="p">,</span> <span class="n">cross_spectrum_errors</span>

    <span class="k">def</span> <span class="nf">compute_stacked_cross_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the cross-spectrum across stacked GP samples.</span>

<span class="sd">        Computes the cross-spectrum for each realization and returns the mean and</span>
<span class="sd">        standard deviation across samples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        norm : bool, optional</span>
<span class="sd">            Whether to normalize the result to power spectral density units.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        freqs : array-like</span>
<span class="sd">            Frequencies of the cross-spectrum.</span>

<span class="sd">        freq_widths : array-like</span>
<span class="sd">            Widths of frequency bins.</span>

<span class="sd">        cross_spectra_mean : array-like</span>
<span class="sd">            Mean cross-spectrum across GP samples.</span>

<span class="sd">        cross_spectra_std : array-like</span>
<span class="sd">            Standard deviation of the cross-spectrum across samples.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cross_spectra</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">cross_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_cross_spectrum</span><span class="p">(</span>
                <span class="n">times1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times1</span><span class="p">,</span> <span class="n">rates1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rates1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">times2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times2</span><span class="p">,</span> <span class="n">rates2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rates2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">norm</span><span class="o">=</span><span class="n">norm</span>
            <span class="p">)</span>
            <span class="n">cross_spectra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_spectrum</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="n">cross_spectra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">cross_spectra</span><span class="p">)</span>
        <span class="c1"># Real and imaginary std devs</span>
        <span class="n">cs_real_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_spectra</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cs_imag_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_spectra</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cs_real_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cross_spectra</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cs_imag_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cross_spectra</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">cross_spectra_mean</span> <span class="o">=</span> <span class="n">cs_real_mean</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">cs_imag_mean</span>
        <span class="n">cross_spectra_std</span> <span class="o">=</span> <span class="n">cs_real_std</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">cs_imag_std</span>
        <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span> <span class="o">=</span> <span class="n">cross_spectrum</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cross_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">cross_spectra_mean</span><span class="p">,</span> <span class="n">cross_spectra_std</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq_widths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cs_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the real and imaginary parts of the cross-spectrum.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        freqs : array-like, optional</span>
<span class="sd">            Frequencies at which the cross-spectrum is evaluated.</span>

<span class="sd">        freq_widths : array-like, optional</span>
<span class="sd">            Widths of the frequency bins.</span>

<span class="sd">        cs : array-like, optional</span>
<span class="sd">            Cross-spectrum values.</span>

<span class="sd">        cs_errors : array-like, optional</span>
<span class="sd">            Uncertainties in the cross-spectrum.</span>

<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments for plot customization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

        <span class="n">freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freqs</span> <span class="k">if</span> <span class="n">freqs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">freqs</span>
        <span class="n">freq_widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_widths</span> <span class="k">if</span> <span class="n">freq_widths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">freq_widths</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cs</span> <span class="k">if</span> <span class="n">cs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">cs</span>
        <span class="n">cs_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cs_errors</span> <span class="k">if</span> <span class="n">cs_errors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">cs_errors</span>

        <span class="n">figsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Cross-Spectrum&#39;</span><span class="p">)</span>
        <span class="n">xscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">yscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;yscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

        <span class="c1"># Real part</span>
        <span class="k">if</span> <span class="n">cs_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">freq_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">cs_errors</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
                         <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>

        <span class="c1"># Imaginary part</span>
        <span class="k">if</span> <span class="n">cs_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">freq_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">cs_errors</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span>
                         <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Imag&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Imag&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">count_frequencies_in_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts the number of frequencies in each frequency bin.</span>
<span class="sd">        Wrapper method to use FrequencyBinning.count_frequencies_in_bins with class attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">count_frequencies_in_bins</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="n">bin_edges</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.cross_spectrum.CrossSpectrum.compute_cross_spectrum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_cross_spectrum</span><span class="p">(</span><span class="n">times1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rates1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">times2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rates2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#stela_toolkit.cross_spectrum.CrossSpectrum.compute_cross_spectrum" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the cross-spectrum for a single pair of light curves.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>times1</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time values for the first light curve.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rates1</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flux or count rate values for the first light curve.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>times2</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time values for the second light curve.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rates2</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flux or count rate values for the second light curve.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>norm</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to normalize the result to power spectral density units.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>freqs</code></td>            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequencies at which the cross-spectrum is evaluated.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>freq_widths</code></td>            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Widths of frequency bins (for error bars or plotting).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>cross_spectrum</code></td>            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Complex cross-spectrum values for each frequency bin.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>cross_spectrum_errors</code></td>            <td>
                  <code><span title="array">array</span> - <span title="like">like</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Uncertainties in the binned cross-spectrum values. None if unbinned.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/cross_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_cross_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">times1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rates1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">times2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rates2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the cross-spectrum for a single pair of light curves.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    times1 : array-like, optional</span>
<span class="sd">        Time values for the first light curve.</span>

<span class="sd">    rates1 : array-like, optional</span>
<span class="sd">        Flux or count rate values for the first light curve.</span>

<span class="sd">    times2 : array-like, optional</span>
<span class="sd">        Time values for the second light curve.</span>

<span class="sd">    rates2 : array-like, optional</span>
<span class="sd">        Flux or count rate values for the second light curve.</span>

<span class="sd">    norm : bool, optional</span>
<span class="sd">        Whether to normalize the result to power spectral density units.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    freqs : array-like</span>
<span class="sd">        Frequencies at which the cross-spectrum is evaluated.</span>

<span class="sd">    freq_widths : array-like</span>
<span class="sd">        Widths of frequency bins (for error bars or plotting).</span>

<span class="sd">    cross_spectrum : array-like</span>
<span class="sd">        Complex cross-spectrum values for each frequency bin.</span>

<span class="sd">    cross_spectrum_errors : array-like or None</span>
<span class="sd">        Uncertainties in the binned cross-spectrum values. None if unbinned.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">times1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times1</span> <span class="k">if</span> <span class="n">times1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">times1</span>
    <span class="n">rates1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates1</span> <span class="k">if</span> <span class="n">rates1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rates1</span>
    <span class="n">times2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times2</span> <span class="k">if</span> <span class="n">times2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">times2</span>
    <span class="n">rates2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rates2</span> <span class="k">if</span> <span class="n">rates2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rates2</span>

    <span class="n">freqs</span><span class="p">,</span> <span class="n">fft1</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times1</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">rates1</span><span class="p">)</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">fft2</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times2</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">rates2</span><span class="p">)</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>

    <span class="n">cross_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">fft1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fft2</span>

    <span class="c1"># Filter frequencies within [fmin, fmax]</span>
    <span class="n">valid_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">freqs</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">)</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span>
    <span class="n">cross_spectrum</span> <span class="o">=</span> <span class="n">cross_spectrum</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span>

    <span class="c1"># Normalize power spectrum to units of variance (PSD)</span>
    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rates1</span><span class="p">)</span>
        <span class="n">norm_factor</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rates1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rates2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">cross_spectrum</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">)</span>

    <span class="c1"># Apply binning</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span><span class="p">:</span>
            <span class="c1"># use custom bin edges</span>
            <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">define_bins</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">,</span>
                <span class="n">bin_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_edges</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">:</span>
            <span class="c1"># use equal-width bins in log or linear space</span>
            <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">define_bins</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_type</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either num_bins or bin_edges must be provided.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;In other words, you must specify the number of bins or the bin edges.&quot;</span><span class="p">)</span>

        <span class="n">binned_cross_spectrum</span> <span class="o">=</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">bin_data</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cross_spectrum</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">)</span>
        <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">cross_spectrum</span><span class="p">,</span> <span class="n">cross_spectrum_errors</span> <span class="o">=</span> <span class="n">binned_cross_spectrum</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">freq_widths</span><span class="p">,</span> <span class="n">cross_spectrum_errors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">cross_spectrum</span><span class="p">,</span> <span class="n">cross_spectrum_errors</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.cross_spectrum.CrossSpectrum.compute_stacked_cross_spectrum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_stacked_cross_spectrum</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#stela_toolkit.cross_spectrum.CrossSpectrum.compute_stacked_cross_spectrum" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the cross-spectrum across stacked GP samples.</p>
<p>Computes the cross-spectrum for each realization and returns the mean and
standard deviation across samples.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>norm</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to normalize the result to power spectral density units.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>freqs</code></td>            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequencies of the cross-spectrum.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>freq_widths</code></td>            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Widths of frequency bins.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>cross_spectra_mean</code></td>            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mean cross-spectrum across GP samples.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>cross_spectra_std</code></td>            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard deviation of the cross-spectrum across samples.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/cross_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_stacked_cross_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the cross-spectrum across stacked GP samples.</span>

<span class="sd">    Computes the cross-spectrum for each realization and returns the mean and</span>
<span class="sd">    standard deviation across samples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    norm : bool, optional</span>
<span class="sd">        Whether to normalize the result to power spectral density units.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    freqs : array-like</span>
<span class="sd">        Frequencies of the cross-spectrum.</span>

<span class="sd">    freq_widths : array-like</span>
<span class="sd">        Widths of frequency bins.</span>

<span class="sd">    cross_spectra_mean : array-like</span>
<span class="sd">        Mean cross-spectrum across GP samples.</span>

<span class="sd">    cross_spectra_std : array-like</span>
<span class="sd">        Standard deviation of the cross-spectrum across samples.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cross_spectra</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rates1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">cross_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_cross_spectrum</span><span class="p">(</span>
            <span class="n">times1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times1</span><span class="p">,</span> <span class="n">rates1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rates1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">times2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times2</span><span class="p">,</span> <span class="n">rates2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rates2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">norm</span><span class="o">=</span><span class="n">norm</span>
        <span class="p">)</span>
        <span class="n">cross_spectra</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_spectrum</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="n">cross_spectra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">cross_spectra</span><span class="p">)</span>
    <span class="c1"># Real and imaginary std devs</span>
    <span class="n">cs_real_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_spectra</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">cs_imag_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_spectra</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">cs_real_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cross_spectra</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">cs_imag_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cross_spectra</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">cross_spectra_mean</span> <span class="o">=</span> <span class="n">cs_real_mean</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">cs_imag_mean</span>
    <span class="n">cross_spectra_std</span> <span class="o">=</span> <span class="n">cs_real_std</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">cs_imag_std</span>
    <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span> <span class="o">=</span> <span class="n">cross_spectrum</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cross_spectrum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">freq_widths</span><span class="p">,</span> <span class="n">cross_spectra_mean</span><span class="p">,</span> <span class="n">cross_spectra_std</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.cross_spectrum.CrossSpectrum.count_frequencies_in_bins" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">count_frequencies_in_bins</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#stela_toolkit.cross_spectrum.CrossSpectrum.count_frequencies_in_bins" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Counts the number of frequencies in each frequency bin.
Wrapper method to use FrequencyBinning.count_frequencies_in_bins with class attributes.</p>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/cross_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">count_frequencies_in_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counts the number of frequencies in each frequency bin.</span>
<span class="sd">    Wrapper method to use FrequencyBinning.count_frequencies_in_bins with class attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">FrequencyBinning</span><span class="o">.</span><span class="n">count_frequencies_in_bins</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">,</span> <span class="n">bin_type</span><span class="o">=</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_edges</span><span class="o">=</span><span class="n">bin_edges</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="stela_toolkit.cross_spectrum.CrossSpectrum.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq_widths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cs_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#stela_toolkit.cross_spectrum.CrossSpectrum.plot" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Plot the real and imaginary parts of the cross-spectrum.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>freqs</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequencies at which the cross-spectrum is evaluated.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>freq_widths</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Widths of the frequency bins.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cs</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cross-spectrum values.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cs_errors</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Uncertainties in the cross-spectrum.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments for plot customization.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>stela_toolkit/cross_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq_widths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cs_errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the real and imaginary parts of the cross-spectrum.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    freqs : array-like, optional</span>
<span class="sd">        Frequencies at which the cross-spectrum is evaluated.</span>

<span class="sd">    freq_widths : array-like, optional</span>
<span class="sd">        Widths of the frequency bins.</span>

<span class="sd">    cs : array-like, optional</span>
<span class="sd">        Cross-spectrum values.</span>

<span class="sd">    cs_errors : array-like, optional</span>
<span class="sd">        Uncertainties in the cross-spectrum.</span>

<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments for plot customization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="n">freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freqs</span> <span class="k">if</span> <span class="n">freqs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">freqs</span>
    <span class="n">freq_widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_widths</span> <span class="k">if</span> <span class="n">freq_widths</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">freq_widths</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cs</span> <span class="k">if</span> <span class="n">cs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">cs</span>
    <span class="n">cs_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cs_errors</span> <span class="k">if</span> <span class="n">cs_errors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">cs_errors</span>

    <span class="n">figsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
    <span class="n">xlabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;Cross-Spectrum&#39;</span><span class="p">)</span>
    <span class="n">xscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">yscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;yscale&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="c1"># Real part</span>
    <span class="k">if</span> <span class="n">cs_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">freq_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">cs_errors</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
                     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>

    <span class="c1"># Imaginary part</span>
    <span class="k">if</span> <span class="n">cs_errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">freq_widths</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">cs_errors</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span>
                     <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Imag&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Imag&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.top", "content.code.copy", "navigation.sections", "navigation.expand"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>